<% 
local fs = require "nixio.fs"
local sys = require "luci.sys"

-- Pengecekan lebih robust
local running = false
local enabled = false

-- Cek status service
local status_fd = io.popen("/etc/init.d/jadwal status 2>&1")
if status_fd then
    running = (status_fd:read("*a"):lower():find("running") ~= nil)
    status_fd:close()
end

-- Cek apakah service enabled
enabled = sys.init.enabled("jadwal")

-- Tentukan tampilan
local status_text = running and "Running" or "Stopped"
local status_class = running and "label-success" or "label-danger"
local enable_text = enabled and "Enabled" or "Disabled"
local enable_class = enabled and "label-success" or "label-danger"
%>
<p>Status Jadwal:
    <span class="label <%= status_class %>"><%= status_text %></span> | 
    <span class="label <%= enable_class %>"><%= enable_text %></span>
